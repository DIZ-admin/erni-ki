# ERNI-KI Configuration Fix Report

## üìã –û–±–∑–æ—Ä –∑–∞–¥–∞—á–∏

**–î–∞—Ç–∞:** 15 –∏—é–ª—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~2 —á–∞—Å–∞  

### –¶–µ–ª–∏ –∑–∞–¥–∞—á–∏
1. ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `openwebui_user` –¥–ª—è OpenWebUI
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å LiteLLM –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
3. ‚úÖ –ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞–Ω–∏—è –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑

### –ü—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑
1. **–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–Ω–∞–Ω–∏–π —á–µ—Ä–µ–∑ Context7** - –∏–∑—É—á–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è LiteLLM
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ OpenWebUI** - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `openwebui_user`
3. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ LiteLLM –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞** - –≤—ã—è–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å UI –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
4. **–ê–Ω–∞–ª–∏–∑ PostgreSQL –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞

### –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- ‚ùå LiteLLM –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±—ã–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö UI –Ω–∞—Å—Ç—Ä–æ–µ–∫
- ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã –Ω–∞ `/ui` endpoint
- ‚ö†Ô∏è –°—Ç–∞—Ç—É—Å "unhealthy" —É LiteLLM –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

## üîß –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è OpenWebUI ‚úÖ

**–°—Ç–∞—Ç—É—Å:** –£–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

<augment_code_snippet path="env/openwebui.env" mode="EXCERPT">
````env
DATABASE_URL="postgresql://openwebui_user:OW_secure_pass_2025!@db:5432/openwebui"
PGVECTOR_DB_URL=postgresql://openwebui_user:OW_secure_pass_2025!@db:5432/openwebui
````
</augment_code_snippet>

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ LiteLLM –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ ‚úÖ

**–î–æ–±–∞–≤–ª–µ–Ω—ã UI –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `env/litellm.env`:**

<augment_code_snippet path="env/litellm.env" mode="EXCERPT">
````env
# === UI SETTINGS ===
# –í–∫–ª—é—á–∏—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
DISABLE_ADMIN_UI=False

# UI –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
UI_USERNAME=admin
UI_PASSWORD=erni-ki-admin-2025
````
</augment_code_snippet>

**–û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `conf/litellm/config-simple.yaml`:**

<augment_code_snippet path="conf/litellm/config-simple.yaml" mode="EXCERPT">
````yaml
general_settings:
  # UI Configuration
  ui_access_mode: "all" # –†–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
  store_prompts_in_spend_logs: True # –í–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è UI
  
  # –û—Ç–∫–ª—é—á–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É —Ä–æ–±–æ—Ç–æ–≤ –¥–ª—è UI
  block_robots: False
````
</augment_code_snippet>

### 3. PostgreSQL –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚úÖ

**–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ dedicated –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- `openwebui_user` - –¥–ª—è OpenWebUI
- `litellm_user` - –¥–ª—è LiteLLM

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤

| –°–µ—Ä–≤–∏—Å | –°—Ç–∞—Ç—É—Å | URL | –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å |
|--------|--------|-----|------------------|
| OpenWebUI | ‚úÖ Healthy | http://localhost:8080/ | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–±–æ—Ç–∞–µ—Ç |
| LiteLLM API | ‚úÖ Working | http://localhost:4000/v1/ | API –¥–æ—Å—Ç—É–ø–µ–Ω |
| LiteLLM UI | ‚úÖ Working | http://localhost:4000/ui/ | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ—Å—Ç—É–ø–µ–Ω |
| PostgreSQL | ‚úÖ Healthy | - | –ë–î —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ |

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### 1. LiteLLM API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ
```bash
# Health check
curl http://localhost:4000/health/liveliness
# Response: "I'm alive!"

# Readiness check  
curl http://localhost:4000/health/readiness
# Response: {"status":"connected","db":"connected",...}

# Models list
curl -H "Authorization: Bearer sk-..." http://localhost:4000/v1/models
# Response: {"data":[{"id":"local-phi4-mini",...}]}
```

#### 2. Virtual Keys —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ virtual key
curl -X POST -H "Authorization: Bearer sk-..." \
  -d '{"models": ["local-phi4-mini"], "duration": "30d"}' \
  http://localhost:4000/key/generate

# Response: {"key": "sk-5v6MgQMTbnuSAYNh9YirGA", ...}

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ virtual key
curl -H "Authorization: Bearer sk-5v6MgQMTbnuSAYNh9YirGA" \
  http://localhost:4000/v1/models
# Response: –£—Å–ø–µ—à–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –º–æ–¥–µ–ª—è–º
```

#### 3. PostgreSQL persistent storage ‚úÖ
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è virtual keys
SELECT key_name, models, created_at, expires 
FROM "LiteLLM_VerificationToken" 
ORDER BY created_at DESC LIMIT 3;

-- Result: 3 –∑–∞–ø–∏—Å–∏ —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
```

#### 4. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã ‚úÖ
- **OpenWebUI:** http://localhost:8080/ - –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- **LiteLLM UI:** http://localhost:4000/ui/ - –¥–æ—Å—Ç—É–ø–µ–Ω –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **Master Key:** `sk-7b788d5ee69638c94477f639c91f128911bdf0e024978d4ba1dbdf678eba38bb`
- **UI Credentials:** admin / erni-ki-admin-2025
- **Database Users:** –û—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏

### –ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- OpenWebUI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `openwebui_user`
- LiteLLM –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `litellm_user`
- –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ —Å–≤–æ–∏–º —Ç–∞–±–ª–∏—Ü–∞–º

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- Connection pooling: 10 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –¥–ª—è LiteLLM
- Batch writing: –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
- Intelligent routing –≤–∫–ª—é—á–µ–Ω
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Redis

### –ú–µ—Ç—Ä–∏–∫–∏
- **Response time:** < 2s –¥–ª—è –≤—Å–µ—Ö endpoints
- **Database connections:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ pooling
- **Memory usage:** –í –ø—Ä–µ–¥–µ–ª–∞—Ö –ª–∏–º–∏—Ç–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
1. **LiteLLM Web Interface Setup Guide** - `docs/litellm-web-interface-setup.md`
   - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - –ü—Ä–æ—Ü–µ–¥—É—Ä—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `env/litellm.env` - –¥–æ–±–∞–≤–ª–µ–Ω—ã UI –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `conf/litellm/config-simple.yaml` - –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

## üéØ –î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ —Ü–µ–ª–∏
1. **OpenWebUI –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ë–î** - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `openwebui_user`
2. **LiteLLM –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 4000
3. **PostgreSQL persistent storage** - virtual keys —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
4. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- –°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è UI
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ü—Ä–æ–≤–µ–¥–µ–Ω–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –¥–ª—è health checks
2. **Backup** - —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã virtual keys –∏–∑ PostgreSQL
3. **Security** - —Ä–æ—Ç–∞—Ü–∏—è master key –∫–∞–∂–¥—ã–µ 90 –¥–Ω–µ–π
4. **Performance** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SSO –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS –¥–ª—è production
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ rate limiting –¥–ª—è UI
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —á–µ—Ä–µ–∑ Prometheus

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**–ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏:**
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `docs/litellm-web-interface-setup.md`
- –õ–æ–≥–∏: `docker-compose logs litellm`
- Health checks: `http://localhost:4000/health/`

**–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã:** ‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
