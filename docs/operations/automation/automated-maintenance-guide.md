---
language: ru
translation_status: complete
doc_version: '2025.11'
---

# ü§ñ Automated Maintenance Guide - ERNI-KI

**Version:** 1.0 **Last Updated:** 2025-10-24 **Status:** Production Ready

---

## 1. –í–≤–µ–¥–µ–Ω–∏–µ

ERNI-KI —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è
–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤. –î–∞–Ω–Ω–æ–µ
—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –∏—Ö —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏
—Å–ø–æ—Å–æ–±—ã —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞.

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç             | –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ       | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ              | –°—Ç–∞—Ç—É—Å    |
| :-------------------- | :--------------- | :---------------------- | :-------- |
| **PostgreSQL VACUUM** | –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ 3:00 | –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö | ‚úÖ Active |
| **Docker Cleanup**    | –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ 4:00 | –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤        | ‚úÖ Active |
| **Log Rotation**      | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ 3:00   | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∞–º–∏       | ‚úÖ Active |
| **System Monitoring** | –ï–∂–µ—á–∞—Å–Ω–æ         | –ü—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è       | ‚úÖ Active |
| **Backrest Backups**  | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ 1:30   | –ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö           | ‚úÖ Active |

## 2. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

–î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è:

- **–î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É:** SSH –¥–æ—Å—Ç—É–ø —Å –ø—Ä–∞–≤–∞–º–∏ root –∏–ª–∏ sudo.
- **Docker:** –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∏ –∑–∞–ø—É—â–µ–Ω–Ω—ã–π Docker Engine.
- **–°–∫—Ä–∏–ø—Ç—ã:** –ù–∞–ª–∏—á–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `scripts/` (–∏–ª–∏ `/tmp/` –¥–ª—è
  –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö legacy –∑–∞–¥–∞—á).
- **–£—Ç–∏–ª–∏—Ç—ã:** `crontab`, `grep`, `tail`.

## 3. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é

### 3.1 PostgreSQL VACUUM

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –º–µ—Å—Ç–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**

- **–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:** –ö–∞–∂–¥–æ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –≤ 3:00
- **–°–∫—Ä–∏–ø—Ç:** `/tmp/pg_vacuum.sh`
- **–õ–æ–≥:** `/tmp/pg_vacuum.log`

**–†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫:**

```bash
/tmp/pg_vacuum.sh
tail -f /tmp/pg_vacuum.log
```

### 3.2 Docker Cleanup

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö Docker —Ä–µ—Å—É—Ä—Å–æ–≤ (–æ–±—Ä–∞–∑—ã, —Ç–æ–º–∞, –∫—ç—à).

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**

- **–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:** –ö–∞–∂–¥–æ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –≤ 4:00
- **–°–∫—Ä–∏–ø—Ç:** `/tmp/docker-cleanup.sh`
- **–õ–æ–≥:** `/tmp/docker-cleanup.log`

**–†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫:**

```bash
/tmp/docker-cleanup.sh
tail -f /tmp/docker-cleanup.log
```

### 3.3 Log Rotation

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∏—Å–∫–∞.

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**

- **Docker Logging:** `json-file`, max-size 10m, max-file 3.
- **–°–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏:** `scripts/rotate-logs.sh` (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 3:00).

**–†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫:**

```bash
./scripts/rotate-logs.sh
```

### 3.4 System Monitoring & Backups

- **Health Monitor:** –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –µ–∂–µ—á–∞—Å–Ω–æ (`scripts/health-monitor.sh`).
- **Backrest Backups:** –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 1:30. –ë—ç–∫–∞–ø—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –¥–∞–Ω–Ω—ã—Ö.

## 4. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤

```bash
# PostgreSQL VACUUM
grep "completed successfully" /tmp/pg_vacuum.log | tail -n 5

# Docker Cleanup
grep "cleanup completed" /tmp/docker-cleanup.log | tail -n 5

# Health Monitor
tail -n 20 .config-backup/monitoring/cron.log
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Cron Jobs

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–ª—É–∂–±—ã cron
systemctl status cron

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ cron
journalctl -u cron --since "1 day ago"
```

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

| –ú–µ—Ç—Ä–∏–∫–∞                 | –¶–µ–ª—å          | –¢–µ–∫—É—â–µ–µ | –°—Ç–∞—Ç—É—Å |
| :---------------------- | :------------ | :------ | :----- |
| **PostgreSQL VACUUM**   | –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ   | –ê–∫—Ç–∏–≤–Ω–æ | ‚úÖ     |
| **Docker Cleanup**      | –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ   | –ê–∫—Ç–∏–≤–Ω–æ | ‚úÖ     |
| **Log Rotation**        | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ | –ê–∫—Ç–∏–≤–Ω–æ | ‚úÖ     |
| **Disk Usage**          | <60%          | 60%     | ‚úÖ     |
| **Backup Success Rate** | >99%          | 100%    | ‚úÖ     |

## 5. –°–≤—è–∑–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [Admin Guide](../admin-guide.md) - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
- [Monitoring Guide](../monitoring/monitoring-guide.md) - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã
- [Docker Cleanup Guide](docker-cleanup-guide.md) - –î–µ—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –æ—á–∏—Å—Ç–∫–∏
- [Docker Log Rotation](docker-log-rotation.md) - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∞–º–∏
