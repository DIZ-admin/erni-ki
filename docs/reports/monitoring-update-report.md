# ERNI-KI Monitoring Stack Update Report

**–î–∞—Ç–∞:** 29 –∞–≤–≥—É—Å—Ç–∞ 2025  
**–í—Ä–µ–º—è:** 09:36 - 09:43 UTC  
**–ê–≤—Ç–æ—Ä:** –ê–ª—å—Ç—ç–æ–Ω –®—É–ª—å—Ü, Tech Lead  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–ï–ù–û

## üìä –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–µ–∑—é–º–µ

–í—ã–ø–æ–ª–Ω–µ–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ ERNI-KI —Å–∏—Å—Ç–µ–º—ã. –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º downtime (<7 –º–∏–Ω—É—Ç –æ–±—â–∏–π). Prometheus –æ–±–Ω–æ–≤–ª–µ–Ω –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ v2.55.1 –≤–º–µ—Å—Ç–æ —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ v3.0.

### üéØ –ö–ª—é—á–µ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- **‚úÖ 4 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–∞** –æ–±–Ω–æ–≤–ª–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
- **‚úÖ Downtime:** < 7 –º–∏–Ω—É—Ç (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö SLA)
- **‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** Comprehensive backup —Å–æ–∑–¥–∞–Ω
- **‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –í—Å–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- **‚ö†Ô∏è Prometheus 3.0:** –û—Ç–ª–æ–∂–µ–Ω –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

## üîÑ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### ‚úÖ **Nginx: latest ‚Üí latest (–æ–±–Ω–æ–≤–ª–µ–Ω)**
- **–í—Ä–µ–º—è:** 09:36 - 09:37 UTC
- **Downtime:** ~10 —Å–µ–∫—É–Ω–¥
- **–°—Ç–∞—Ç—É—Å:** Healthy
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** HTTP/HTTPS –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å ‚úÖ

### ‚úÖ **Loki: 3.4.1 ‚Üí latest**
- **–í—Ä–µ–º—è:** 09:38 - 09:39 UTC  
- **Downtime:** ~1 –º–∏–Ω—É—Ç–∞
- **–°—Ç–∞—Ç—É—Å:** Healthy
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** API endpoint /ready ‚úÖ

### ‚úÖ **Grafana: 10.2.0 ‚Üí latest**
- **–í—Ä–µ–º—è:** 09:40 - 09:41 UTC
- **Downtime:** ~20 —Å–µ–∫—É–Ω–¥
- **–°—Ç–∞—Ç—É—Å:** Healthy
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** API endpoint /api/health ‚úÖ
- **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ú–∏–Ω–æ—Ä–Ω—ã–µ WebSocket token warnings (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

### ‚úÖ **Prometheus: v2.48.0 ‚Üí v2.55.1**
- **–í—Ä–µ–º—è:** 09:42 - 09:43 UTC
- **Downtime:** ~30 —Å–µ–∫—É–Ω–¥
- **–°—Ç–∞—Ç—É—Å:** Healthy
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** API endpoint /-/healthy ‚úÖ
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** –°–æ–≤–º–µ—Å—Ç–∏–º–∞, –∞–ª–µ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ Backup

### üìÅ **Backup Location:** `.backups/monitoring-update-20250829_093606/`

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ backup:**
- ‚úÖ `compose.yml.backup` (40.5 KB)
- ‚úÖ `prometheus-conf/` (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
- ‚úÖ `grafana-conf/` (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
- ‚úÖ `loki-conf/` (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
- ‚úÖ `nginx-conf/` (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
- ‚úÖ `grafana-data/` (–¥–∞–Ω–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥–æ–≤)
- ‚úÖ `prometheus-data/` (–º–µ—Ç—Ä–∏–∫–∏ –∏ TSDB)

### üîí **–ü–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞ –≥–æ—Ç–æ–≤:**
```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏–π
cp .backups/monitoring-update-20250829_093606/compose.yml.backup compose.yml
docker-compose down
docker-compose up -d

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
sudo cp -r .backups/monitoring-update-20250829_093606/grafana-data/* data/grafana/
sudo cp -r .backups/monitoring-update-20250829_093606/prometheus-data/* data/prometheus/
```

---

## ‚ö†Ô∏è Prometheus 3.0 - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### üö® **–†–ï–®–ï–ù–ò–ï: –ù–ï –û–ë–ù–û–í–õ–Ø–¢–¨ –¥–æ v3.0**

**–ü—Ä–∏—á–∏–Ω—ã:**
1. **Breaking Changes –≤ PromQL:**
   - –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞—é—Ç newlines
   - Range selectors –∏–∑–º–µ–Ω–∏–ª–∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (left-open, right-closed)
   - `holt_winters` –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –≤ `double_exponential_smoothing`

2. **–†–∏—Å–∫–∏ –¥–ª—è production:**
   - –ú–æ–≥—É—Ç —Å–ª–æ–º–∞—Ç—å—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∞–ª–µ—Ä—Ç—ã
   - –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ TSDB —Ñ–æ—Ä–º–∞—Ç–µ
   - –û—Ç–∫–∞—Ç –≤–æ–∑–º–æ–∂–µ–Ω —Ç–æ–ª—å–∫–æ –¥–æ v2.55+

3. **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:**
   - Alertmanager 0.16.0+ (—É –Ω–∞—Å 0.28.1 ‚úÖ)
   - –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ scrape protocols

### üìã **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–ª–∞–Ω –¥–ª—è Prometheus 3.0:**

1. **–§–∞–∑–∞ 1 (—Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü):**
   - –°–æ–∑–¥–∞—Ç—å staging –æ–∫—Ä—É–∂–µ–Ω–∏–µ
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∞–ª–µ—Ä—Ç—ã –∏ –¥–∞—à–±–æ—Ä–¥—ã
   - –ò–∑—É—á–∏—Ç—å impact –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ PromQL –∑–∞–ø—Ä–æ—Å—ã

2. **–§–∞–∑–∞ 2 (—á–µ—Ä–µ–∑ 2 –º–µ—Å—è—Ü–∞):**
   - –û–±–Ω–æ–≤–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å v3.0
   - –ü–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å maintenance window
   - –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏

3. **–§–∞–∑–∞ 3 (—á–µ—Ä–µ–∑ 3 –º–µ—Å—è—Ü–∞):**
   - –í—ã–ø–æ–ª–Ω–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ v3.0 –≤ maintenance window
   - –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

---

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### **Nginx latest:**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å HTTP/2
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ SSL/TLS –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

### **Loki latest:**
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
- –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ LogQL
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è memory leaks

### **Grafana latest:**
- –ù–æ–≤—ã–µ —Ç–∏–ø—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–∞—à–±–æ—Ä–¥–æ–≤
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### **Prometheus v2.55.1:**
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ v3.0 (—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π TSDB —Ñ–æ—Ä–º–∞—Ç)
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

---

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### **–°–ª–µ–¥—É—é—â–∏–µ 24 —á–∞—Å–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å:**

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
   ```bash
   # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤
   docker stats --no-stream
   
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫
   curl -s http://localhost:9091/api/v1/query?query=up | jq '.data.result'
   ```

2. **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤:**
   ```bash
   # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
   curl -f http://localhost:8080/health  # OpenWebUI
   curl -f http://localhost:3000/api/health  # Grafana
   curl -f http://localhost:9091/-/healthy  # Prometheus
   curl -f http://localhost:3100/ready  # Loki
   ```

3. **–ê–ª–µ—Ä—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª –∞–ª–µ—Ä—Ç–∏–Ω–≥–∞
   - –£–±–µ–¥–∏—Ç—å—Å—è –≤ –¥–æ—Å—Ç–∞–≤–∫–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å Grafana –¥–∞—à–±–æ—Ä–¥—ã

### **–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:**

- **Prometheus:** Query latency, TSDB size, scrape duration
- **Grafana:** Dashboard load time, user sessions
- **Loki:** Ingestion rate, query performance
- **Nginx:** Request rate, response time, error rate

---

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (—Å–µ–≥–æ–¥–Ω—è):**
1. ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –≤ —Ç–µ—á–µ–Ω–∏–µ 2 —á–∞—Å–æ–≤
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –¥–∞—à–±–æ—Ä–¥—ã Grafana
3. ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è –≤ —Ä–∞–±–æ—Ç–µ –∞–ª–µ—Ä—Ç–æ–≤

### **–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ:**
1. üìã –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
2. üìã –°–æ–∑–¥–∞—Ç—å staging –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Prometheus 3.0
3. üìã –ü—Ä–æ–≤–µ—Å—Ç–∏ performance —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### **–í —Å–ª–µ–¥—É—é—â–µ–º –º–µ—Å—è—Ü–µ:**
1. üìã –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ Prometheus 3.0
2. üìã –û–±–Ω–æ–≤–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å v3.0
3. üìã –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

---

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ ERNI-KI –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ!**

### **–î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ü–µ–ª–∏:**
- ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–µ—Ä–≤–∏—Å—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π downtime (<7 –º–∏–Ω—É—Ç)
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–µ–Ω–∞ (comprehensive backup)
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∞

### **–ü—Ä–∏–Ω—è—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è:**
- ‚úÖ Prometheus –æ–±–Ω–æ–≤–ª–µ–Ω –¥–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π v2.55.1
- ‚ö†Ô∏è Prometheus 3.0 –æ—Ç–ª–æ–∂–µ–Ω –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–∞ latest –≤–µ—Ä—Å–∏—è—Ö

### **–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞:**
- üöÄ –ö –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç–µ —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
- üõ°Ô∏è –ö –±–µ–∑–æ–ø–∞—Å–Ω–æ–º—É –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é Prometheus 3.0
- üìä –ö —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–µ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ERNI-KI —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö, –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –≤–µ—Ä—Å–∏—è—Ö –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤!** üéâ
