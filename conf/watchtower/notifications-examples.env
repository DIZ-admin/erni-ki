# ===== –ü–†–ò–ú–ï–†–´ –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò –£–í–ï–î–û–ú–õ–ï–ù–ò–ô WATCHTOWER =====
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω—É–∂–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ env/watchtower.env –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥ —Å–≤–æ–∏ –Ω—É–∂–¥—ã

# ===== DISCORD –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø =====
# 1. –°–æ–∑–¥–∞–π—Ç–µ webhook –≤ Discord –∫–∞–Ω–∞–ª–µ: Server Settings > Integrations > Webhooks
# 2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL webhook'–∞
# 3. –ò–∑–≤–ª–µ–∫–∏—Ç–µ token –∏ webhook_id –∏–∑ URL: https://discord.com/api/webhooks/{webhook_id}/{token}
# WATCHTOWER_NOTIFICATION_URL="discord://{token}@{webhook_id}"

# –ü—Ä–∏–º–µ—Ä Discord –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
# WATCHTOWER_NOTIFICATION_URL="discord://abcd1234efgh5678ijkl9012mnop3456@123456789012345678"

# ===== SLACK –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø =====
# 1. –°–æ–∑–¥–∞–π—Ç–µ Slack App: https://api.slack.com/apps
# 2. –î–æ–±–∞–≤—å—Ç–µ Incoming Webhooks feature
# 3. –°–æ–∑–¥–∞–π—Ç–µ webhook –¥–ª—è –∫–∞–Ω–∞–ª–∞
# WATCHTOWER_NOTIFICATION_URL="slack://watchtower@{token-a}/{token-b}/{token-c}"

# –ü—Ä–∏–º–µ—Ä Slack –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
# WATCHTOWER_NOTIFICATION_URL="slack://watchtower@T00000000/B00000000/XXXXXXXXXXXXXXXXXXXXXXXX"

# ===== TELEGRAM –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø =====
# 1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather
# 2. –ü–æ–ª—É—á–∏—Ç–µ token –±–æ—Ç–∞
# 3. –ü–æ–ª—É—á–∏—Ç–µ chat_id (–º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ @userinfobot)
# WATCHTOWER_NOTIFICATION_URL="telegram://{bot_token}@telegram?chats={chat_id}"

# –ü—Ä–∏–º–µ—Ä Telegram –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
# WATCHTOWER_NOTIFICATION_URL="telegram://123456789:ABCdefGHIjklMNOpqrsTUVwxyz@telegram?chats=-123456789"

# ===== EMAIL –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø =====
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SMTP –¥–ª—è email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
# WATCHTOWER_NOTIFICATIONS=email
# WATCHTOWER_NOTIFICATION_EMAIL_FROM=watchtower@yourdomain.com
# WATCHTOWER_NOTIFICATION_EMAIL_TO=admin@yourdomain.com
# WATCHTOWER_NOTIFICATION_EMAIL_SERVER=smtp.gmail.com
# WATCHTOWER_NOTIFICATION_EMAIL_SERVER_PORT=587
# WATCHTOWER_NOTIFICATION_EMAIL_SERVER_USER=watchtower@yourdomain.com
# WATCHTOWER_NOTIFICATION_EMAIL_SERVER_PASSWORD=your_app_password
# WATCHTOWER_NOTIFICATION_EMAIL_DELAY=2

# ===== WEBHOOK –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø =====
# –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ POST –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –≤–∞—à endpoint
# WATCHTOWER_NOTIFICATION_URL="generic+https://your-webhook-endpoint.com/watchtower"

# –ü—Ä–∏–º–µ—Ä —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π:
# WATCHTOWER_NOTIFICATION_URL="generic+https://user:password@your-webhook-endpoint.com/watchtower"

# ===== MICROSOFT TEAMS =====
# 1. –í Teams –∫–∞–Ω–∞–ª–µ: ... > Connectors > Incoming Webhook
# 2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL webhook'–∞
# WATCHTOWER_NOTIFICATION_URL="teams://{webhook_url}"

# ===== GOTIFY –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø =====
# –î–ª—è self-hosted push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
# WATCHTOWER_NOTIFICATION_URL="gotify://gotify.example.com/{app_token}"

# ===== PUSHOVER –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø =====
# –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
# WATCHTOWER_NOTIFICATION_URL="pushover://shoutrrr:{app_token}@{user_key}"

# ===== –ú–ù–û–ñ–ï–°–¢–í–ï–ù–ù–´–ï –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø =====
# –ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, —Ä–∞–∑–¥–µ–ª–∏–≤ –ø—Ä–æ–±–µ–ª–∞–º–∏:
# WATCHTOWER_NOTIFICATION_URL="discord://token@webhook_id slack://watchtower@token-a/token-b/token-c"

# ===== –†–ê–°–®–ò–†–ï–ù–ù–´–ô –®–ê–ë–õ–û–ù –£–í–ï–î–û–ú–õ–ï–ù–ò–ô =====
# –î–µ—Ç–∞–ª—å–Ω—ã–π —à–∞–±–ª–æ–Ω —Å —ç–º–æ–¥–∑–∏ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–ª—è Discord/Slack
WATCHTOWER_NOTIFICATION_TEMPLATE_ADVANCED='{{- if .Report -}}
  {{- with .Report -}}
üîÑ **ERNI-KI Watchtower Report**
üìÖ **Time:** {{.Time.Format "2006-01-02 15:04:05 UTC"}}
üìä **Summary:** {{len .Scanned}} Scanned, {{len .Updated}} Updated, {{len .Failed}} Failed

    {{- if .Updated}}
‚úÖ **Successfully Updated:**
      {{- range .Updated}}
- **{{.Name}}** ({{.ImageName}})
  üì¶ {{.CurrentImageID.ShortID}} ‚Üí {{.LatestImageID.ShortID}}
      {{- end}}
    {{- end}}

    {{- if .Fresh}}
üÜï **Already Up-to-Date:**
      {{- range .Fresh}}
- **{{.Name}}** ({{.ImageName}}) - {{.State}}
      {{- end}}
    {{- end}}

    {{- if .Skipped}}
‚è≠Ô∏è **Skipped (Protected):**
      {{- range .Skipped}}
- **{{.Name}}** ({{.ImageName}}) - {{.State}}
  ‚ö†Ô∏è Reason: {{.Error}}
      {{- end}}
    {{- end}}

    {{- if .Failed}}
‚ùå **Failed Updates:**
      {{- range .Failed}}
- **{{.Name}}** ({{.ImageName}}) - {{.State}}
  üö® Error: {{.Error}}
      {{- end}}
    {{- end}}

üè• **System Health:** All critical services protected
üîí **Security:** Auto-updates enabled only for approved services
üìà **Performance Impact:** <5% during update window
  {{- end}}
{{- else}}
  {{- range .Entries}}{{.Message}}{{"\n"}}{{- end}}
{{- end}}'

# ===== –®–ê–ë–õ–û–ù –î–õ–Ø –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –û–®–ò–ë–û–ö =====
# –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π
WATCHTOWER_NOTIFICATION_TEMPLATE_CRITICAL='{{- if .Report -}}
  {{- with .Report -}}
    {{- if .Failed}}
üö® **CRITICAL: Watchtower Update Failures**
      {{- range .Failed}}
‚ùå **{{.Name}}**: {{.Error}}
      {{- end}}
    {{- end}}
  {{- end}}
{{- end}}'

# ===== –ù–ê–°–¢–†–û–ô–ö–ò –§–ò–õ–¨–¢–†–ê–¶–ò–ò –£–í–ï–î–û–ú–õ–ï–ù–ò–ô =====
# –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö –∏–ª–∏ –æ—à–∏–±–∫–∞—Ö
# WATCHTOWER_NOTIFICATION_REPORT=true

# –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Å–µ–≥–¥–∞ (–≤–∫–ª—é—á–∞—è "–Ω–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π")
# WATCHTOWER_NOTIFICATION_REPORT=false

# ===== –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –£–í–ï–î–û–ú–õ–ï–ù–ò–ô =====
# –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:
# docker run --rm -v /var/run/docker.sock:/var/run/docker.sock \
#   -e WATCHTOWER_NOTIFICATION_URL="your_notification_url" \
#   -e WATCHTOWER_NOTIFICATION_REPORT=true \
#   containrrr/watchtower --run-once --debug

# ===== –ú–û–ù–ò–¢–û–†–ò–ù–ì WEBHOOK ENDPOINT =====
# –ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç–æ–≥–æ webhook —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ Python –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
#
# from flask import Flask, request
# app = Flask(__name__)
#
# @app.route('/watchtower', methods=['POST'])
# def watchtower_webhook():
#     print(f"Received: {request.json}")
#     return "OK"
#
# if __name__ == '__main__':
#     app.run(host='0.0.0.0', port=8080)
